<div class="document-content invoice-detail-content">
  <h3 class="icon-space">
    <button placement="bottom" *ngIf="x_data_req_page !== 'new-invoice'" class="btn-icon icon-title" (click)="goBack()">
      <i class="icon-arrow-left"></i>
    </button>
    DETALLE DE FACTURA
    <div class="btn-options">
      <div *ngIf="canceledInvoice && cancellationReason.length > 0" class="alert alert-danger alert-sm">
        <i class="mdi mdi-alert-outline"></i> Factura Anulada
      </div>
      <button *ngIf="!canceledInvoice" (click)="changeInvoiceFormat()" class="btn btn-sm btn-outline-secondary btn-icon-space">
        <i class="mdi mdi-eye-outline"></i> {{ (invoiceType==="letter") ? "VER FACTURA SIMPLIFICADA" : "VER FACTURA
        COMPLETA" }}
      </button>
      <button *ngIf="x_data_req_page === 'new-invoice'" (click)="goBack()" class="btn btn-sm btn-outline-secondary btn-icon-space" type="submit">
        <i class="icon-file-text"></i> NUEVA FACTURA
      </button>

      <button *ngIf="x_data_req_page !== 'new-invoice' && !canceledInvoice" [disabled]="!invoiceB64"
              class="btn btn-sm btn-outline-success btn-icon-space" type="submit" (click)="openModal(content)">
        <i class="mdi mdi-send"></i> Enviar por mail
      </button>

    </div>
  </h3>
  <div class="post-it-note" *ngIf="canceledInvoice && cancellationReason.length > 0">
    {{cancellationReason}}
  </div>
  <!--<ngb-alert *ngIf="successMessage" type="{{typeAlert}}" (close)="successMessage = null">{{ successMessage }}
  </ngb-alert>-->
  <object *ngIf="invoiceB64" [data]="invoiceB64" type="application/pdf" width="100%" height="100%">
    <p><b>Example fallback content</b>: This browser does not support PDFs. Please download the PDF to view it:
      <a [href]="invoiceB64">Download PDF</a>.</p>
  </object>
</div>


<ng-template #content>
  <div class="modal-header">
    <h4 class="modal-title">Enviar Factura</h4>
    <button type="button" class="close" aria-label="Close" (click)="closeModal()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="col-md-12">
      <div class="row">
        <div class="col-12">
          <form class="profile-form" #mailForm="ngForm">
            <fieldset>
              <div class="form-group">
                <label for="email">Email</label>
                <input id="email" type="text" class="form-control" placeholder="Ejm. juan@mail.com"
                       email maxlength="50" minlength="5" required name="email"
                       [(ngModel)]="email" #refEmail="ngModel">
                <div *ngIf="refEmail.invalid && (refEmail.dirty || refEmail.touched)"
                     class="form-text text-danger">
                  <div *ngIf="refEmail?.errors.required">
                    Email es requerido.
                  </div>
                  <div *ngIf="refEmail?.errors.email">
                    Email es inválido.
                  </div>
                  <div *ngIf="refEmail?.errors.minlength">
                    El email debe tener al menos 5 caracteres.
                  </div>
                  <div *ngIf="refEmail?.errors.maxlength">
                    El email no puede tener más de 50 caracteres.
                  </div>
                </div>
              </div>
            </fieldset>
          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="closeModal()">Cancelar</button>
    <button type="button" class="btn btn-primary"
            [disabled]="mailForm.form.invalid" (click)="sendEmail()">Enviar
    </button>
  </div>
</ng-template>
